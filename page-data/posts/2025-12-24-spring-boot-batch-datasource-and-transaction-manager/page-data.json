{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/posts/2025-12-24-spring-boot-batch-datasource-and-transaction-manager/","result":{"data":{"post":{"html":"<h3 id=\"spring-274spring-batch-4\" style=\"position:relative;\"><a href=\"#spring-274spring-batch-4\" aria-label=\"spring 274spring batch 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>spring 2.7.4(spring batch 4)</h3>\n<ul>\n<li>í•˜ë‚˜ì˜ datasourceë§Œ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ” EnableBatchProcessing ì–´ë…¸í…Œì´ì…˜ + application.yaml(spring.datasource) ë¡œ ì„¤ì •í•˜ë©´ ë¨</li>\n<li>ìœ„ ë°©ë²•ë§Œìœ¼ë¡œ ì›í•˜ëŠ” ì„¤ì •ì´ ë¶ˆê°€ëŠ¥í•œ ê²½ìš°ì—ëŠ” ì•„ë˜ì™€ ê°™ì´ ì§„í–‰</li>\n<li>DefaultBatchConfigurerì˜ getTransactionManager / set(get)DataSource overrideë¥¼ í†µí•´ ê°€ëŠ¥í•´ë³´ì„</li>\n<li>in-memoryë¡œ ì“°ê³  ì‹¶ì€ ê²½ìš° DefaultBatchConfigurerì˜ setDataSource ë©”ì†Œë“œë¥¼ overrideí•˜ë©´ MapJobRepository ë¡œ ì‚¬ìš© ê°€ëŠ¥</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token annotation builtin\">@Configuration</span>\n<span class=\"token keyword\">class</span> BatchConfig<span class=\"token operator\">:</span> <span class=\"token function\">DefaultBatchConfigurer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">fun</span> <span class=\"token function\">setDataSource</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token operator\">:</span> DataSource<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// do nothing</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"spring-325spring-batch-5\" style=\"position:relative;\"><a href=\"#spring-325spring-batch-5\" aria-label=\"spring 325spring batch 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>spring 3.2.5(spring batch 5)</h3>\n<ul>\n<li>í•˜ë‚˜ì˜ datasourceë§Œ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ” EnableBatchProcessing ì–´ë…¸í…Œì´ì…˜ + application.yaml(spring.datasource) ë¡œ ì„¤ì •í•˜ë©´ ë¨</li>\n<li>ìœ„ ë°©ë²•ë§Œìœ¼ë¡œ ì›í•˜ëŠ” ì„¤ì •ì´ ë¶ˆê°€ëŠ¥í•œ ê²½ìš°ì—ëŠ” ì•„ë˜ì™€ ê°™ì´ ì§„í–‰</li>\n<li>DefaultBatchConfigurationì˜ getTransactionManager / getDataSource overrideë¥¼ í†µí•´ ê°€ëŠ¥í•  ê²ƒìœ¼ë¡œ ë³´ì„</li>\n<li>in-memoryë¡œ ì“°ê³  ì‹¶ì€ ê²½ìš° h2 database ì‚¬ìš© í•„ìš”. DefaultBatchConfigurer / MapJobRepository ê°€ removed ë˜ì–´ ì•„ë˜ì™€ ê°™ì´ ì—°ë™</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token annotation builtin\">@Configuration</span>\n<span class=\"token keyword\">class</span> BatchConfig <span class=\"token operator\">:</span> <span class=\"token function\">DefaultBatchConfiguration</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// override í•˜ì§€ ì•Šìœ¼ë©´ primary DataSource bean ì´ ì£¼ì…ë¨</span>\n  <span class=\"token keyword\">override</span> <span class=\"token keyword\">fun</span> <span class=\"token function\">getDataSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> DataSource <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> datasource\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// override í•˜ì§€ ì•Šìœ¼ë©´ primary PlatformTransactionManager bean ì´ ì£¼ì…ë¨</span>\n  <span class=\"token keyword\">override</span> <span class=\"token keyword\">fun</span> <span class=\"token function\">getTransactionManager</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> PlatformTransactionManager <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">DataSourceTransactionManager</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// BatchAutoConfiguration ê°€ @ConditionalOnMissingBean(value = DefaultBatchConfiguration.class, annotation = EnableBatchProcessing.class) ì–´ë…¸í…Œì´ì…˜ì„ ê°€ì§€ê³  ìˆìŒ</span>\n  <span class=\"token comment\">// ì´ë¡œ ì¸í•´ DefaultBatchConfiguration ë¥¼ ìƒì†ë°›ì€ Configurationì´ ìˆìœ¼ë©´ JobLauncherApplicationRunner ê°€ ë“±ë¡ë˜ì§€ ì•Šì•„ bean ë“±ë¡</span>\n  <span class=\"token annotation builtin\">@Bean</span>\n  <span class=\"token keyword\">fun</span> <span class=\"token function\">jobLauncherApplicationRunner</span><span class=\"token punctuation\">(</span>\n    jobLauncher<span class=\"token operator\">:</span> JobLauncher<span class=\"token punctuation\">,</span>\n    jobExplorer<span class=\"token operator\">:</span> JobExplorer<span class=\"token punctuation\">,</span>\n    jobRepository<span class=\"token operator\">:</span> JobRepository<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> JobLauncherApplicationRunner <span class=\"token operator\">=</span> <span class=\"token function\">JobLauncherApplicationRunner</span><span class=\"token punctuation\">(</span>jobLauncher<span class=\"token punctuation\">,</span> jobExplorer<span class=\"token punctuation\">,</span> jobRepository<span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">companion</span> <span class=\"token keyword\">object</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// DefaultBatchConfiguration bean lite mode(proxyBeanMethods = false)ë¡œ ì¸í•´ getDataSource ë©”ì†Œë“œ ë‚´ì— ë‘ë©´ ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œë˜ì–´ ë™ì¼í•œ DB ì—”ë“œí¬ì¸íŠ¸ë¡œ DDL ì—¬ëŸ¬ ë²ˆ ë°œìƒ</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">val</span> datasource <span class=\"token operator\">=</span> <span class=\"token function\">EmbeddedDatabaseBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">setType</span><span class=\"token punctuation\">(</span>EmbeddedDatabaseType<span class=\"token punctuation\">.</span>H2<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">addScript</span><span class=\"token punctuation\">(</span><span class=\"token string-literal singleline\"><span class=\"token string\">\"org/springframework/batch/core/schema-h2.sql\"</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"spring-4spring-batch-6\" style=\"position:relative;\"><a href=\"#spring-4spring-batch-6\" aria-label=\"spring 4spring batch 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>spring 4(spring batch 6)</h3>\n<ul>\n<li>EnableBatchProcessing ì–´ë…¸í…Œì´ì…˜ + application.yaml(spring.datasource) ë¡œ ì„¤ì •í•˜ë©´ ë¨</li>\n<li>ìœ„ ë°©ë²•ë§Œìœ¼ë¡œ ì›í•˜ëŠ” ì„¤ì •ì´ ë¶ˆê°€ëŠ¥í•œ ê²½ìš°ì—ëŠ” ì•„ë˜ì™€ ê°™ì´ ì§„í–‰</li>\n<li>BatchAutoConfiguration + BatchDataSource / BatchTransactionManager ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ dataSource / transactionManager ë¥¼ ë“±ë¡í•˜ë©´ ë˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì„</li>\n</ul>\n<h2 id=\"ì—¬ë‹´\" style=\"position:relative;\"><a href=\"#%EC%97%AC%EB%8B%B4\" aria-label=\"ì—¬ë‹´ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì—¬ë‹´</h2>\n<ul>\n<li>spring boot 3.2.5ì—ì„œ DefaultBatchConfiguration ì— ì˜í•´ getDataSource ë©”ì†Œë“œê°€ ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œë¨</li>\n<li>DefaultBatchConfigurationëŠ” bean lite modeë¡œ ë˜ì–´ ìˆì–´ í˜¸ì¶œ ì‹œë§ˆë‹¤ EmbeddedDatabaseBuilder ê°€ ë‹¤ì‹œ buildë˜ë©´ì„œ ë™ì¼í•œ í…Œì´ë¸”ì— ëŒ€í•´ DDLì´ ì—¬ëŸ¬ ë²ˆ ë‚˜ê°€ê²Œ ë˜ì—ˆìŒ</li>\n<li>ì´ë¡œ ì¸í•´ <code class=\"language-text\">Table already exists</code> ì—ëŸ¬ê°€ ë°œìƒí•˜ë©° ì–´í”Œë¦¬ì¼€ì´ì…˜ ê¸°ë™ì´ ì‹¤íŒ¨í•¨. ì´ì „ì— <a href=\"https://cprayer.github.io/posts/2021-03-17-about-bean-lite-mode/\">spring bean lite modeì— ëŒ€í•´ ê³µë¶€</a>í•œ ì ì´ ìˆì–´ ë””ë²„ê¹…í•˜ëŠ” ì‹œê°„ì„ ë‹¨ì¶•í•  ìˆ˜ ìˆì—ˆìŒ</li>\n<li>spring boot 3.2.5 ì—ì„œëŠ” BatchDataSource ì–´ë…¸í…Œì´ì…˜ë§Œ ìˆê³  BatchTransactionManager ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ë°°ì¹˜ìš© TransactionManager Beanì„ ë³„ë„ ì£¼ì…ë°›ëŠ”ê²Œ ì•ˆë˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì—¬ ì»¨íŠ¸ë¦¬ë·°ì…˜ í•  ìˆ˜ë„ ìˆê² ë‹¤ ì‹¶ì–´ ì°¾ì•„ë´¤ëŠ”ë° spring batch 6ì—ëŠ” ì´ë¯¸ ì¶”ê°€ë˜ì–´ ìˆì–´ ì‹¤íŒ¨ğŸ˜¢</li>\n</ul>","excerpt":"spring 2.7.4(spring batch 4) í•˜ë‚˜ì˜ datasourceë§Œ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ” EnableBatchProcessing ì–´ë…¸í…Œì´ì…˜ + application.yaml(spring.datasourceâ€¦","timeToRead":2,"fields":{"slug":"/posts/2025-12-24-spring-boot-batch-datasource-and-transaction-manager/"},"frontmatter":{"tags":["spring","spring-batch"],"author":{"jsonId":"cprayer","bio":"","twitter":"@fabien0102","avatar":{"children":[{"fixed":{"src":"/static/5d0fd80a1d7df4f6a3adf452cc763c07/b0b39/cprayer.jpg","srcSet":"/static/5d0fd80a1d7df4f6a3adf452cc763c07/b0b39/cprayer.jpg 1x,\n/static/5d0fd80a1d7df4f6a3adf452cc763c07/93542/cprayer.jpg 1.5x,\n/static/5d0fd80a1d7df4f6a3adf452cc763c07/aa4d2/cprayer.jpg 2x"}}]}},"title":"spring boot 2 / 3 / 4(spring batch 4 / 5 / 6) ì—ì„œ ë°°ì¹˜ìš© datasource / platformTransactionManager ì„¤ì • ë°©ë²•","updatedDate":"Dec 24, 2025","image":null}},"recents":{"edges":[{"node":{"fields":{"slug":"/posts/2025-12-26-mongo-document-ttl/"},"timeToRead":1,"frontmatter":{"title":"mongo document ê°€ ë™ì‹œì— ëŒ€ëŸ‰ ttl expired ë  ë•Œ ë™ì‘","image":null,"author":{"jsonId":"cprayer","avatar":{"children":[{"fixed":{"src":"/static/5d0fd80a1d7df4f6a3adf452cc763c07/6d45f/cprayer.jpg","srcSet":"/static/5d0fd80a1d7df4f6a3adf452cc763c07/6d45f/cprayer.jpg 1x,\n/static/5d0fd80a1d7df4f6a3adf452cc763c07/fe190/cprayer.jpg 1.5x,\n/static/5d0fd80a1d7df4f6a3adf452cc763c07/3e51d/cprayer.jpg 2x"}}]}}}}},{"node":{"fields":{"slug":"/posts/2025-12-24-java-rint-kotlin-round/"},"timeToRead":1,"frontmatter":{"title":"kotlin.math.round(4.5) = kotlin.math.round(3.5) ?, ì‚¬ì‚¬ì˜¤ì…ê³¼ ì˜¤ì‚¬ì˜¤ì…(Round half to even)","image":null,"author":{"jsonId":"cprayer","avatar":{"children":[{"fixed":{"src":"/static/5d0fd80a1d7df4f6a3adf452cc763c07/6d45f/cprayer.jpg","srcSet":"/static/5d0fd80a1d7df4f6a3adf452cc763c07/6d45f/cprayer.jpg 1x,\n/static/5d0fd80a1d7df4f6a3adf452cc763c07/fe190/cprayer.jpg 1.5x,\n/static/5d0fd80a1d7df4f6a3adf452cc763c07/3e51d/cprayer.jpg 2x"}}]}}}}},{"node":{"fields":{"slug":"/posts/2025-11-24-mysql-index/"},"timeToRead":2,"frontmatter":{"title":"mysql ì¸ë±ìŠ¤ ê´€ë ¨ ì •ë¦¬","image":null,"author":{"jsonId":"cprayer","avatar":{"children":[{"fixed":{"src":"/static/5d0fd80a1d7df4f6a3adf452cc763c07/6d45f/cprayer.jpg","srcSet":"/static/5d0fd80a1d7df4f6a3adf452cc763c07/6d45f/cprayer.jpg 1x,\n/static/5d0fd80a1d7df4f6a3adf452cc763c07/fe190/cprayer.jpg 1.5x,\n/static/5d0fd80a1d7df4f6a3adf452cc763c07/3e51d/cprayer.jpg 2x"}}]}}}}},{"node":{"fields":{"slug":"/posts/2025-11-23-mismatch-docker-image-size/"},"timeToRead":1,"frontmatter":{"title":"docker image layerëŠ” ì••ì¶• ê°€ëŠ¥í•˜ë‹¤","image":null,"author":{"jsonId":"cprayer","avatar":{"children":[{"fixed":{"src":"/static/5d0fd80a1d7df4f6a3adf452cc763c07/6d45f/cprayer.jpg","srcSet":"/static/5d0fd80a1d7df4f6a3adf452cc763c07/6d45f/cprayer.jpg 1x,\n/static/5d0fd80a1d7df4f6a3adf452cc763c07/fe190/cprayer.jpg 1.5x,\n/static/5d0fd80a1d7df4f6a3adf452cc763c07/3e51d/cprayer.jpg 2x"}}]}}}}}]}},"pageContext":{"slug":"/posts/2025-12-24-spring-boot-batch-datasource-and-transaction-manager/"}},"staticQueryHashes":[],"slicesMap":{}}